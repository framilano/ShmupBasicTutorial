pico-8 cartridge // http://www.pico-8.com
version 41
__lua__

function _init()
	cls()
	global_vars = {
		frame_counter = 0
	}
	

	--set mode to start
	change_mode_and_reset("start")
end

function _update()
	if (mode == "start") update_start()
	if (mode == "game") update_game()
	if (mode == "over") update_over()
	if (mode == "wave") update_wave()
	global_vars.frame_counter += 1
	update_timers()
end

function _draw()
	if (mode == "start") draw_start()
	if (mode == "game") draw_game()
	if (mode == "over") draw_over()
	if (mode == "wave") draw_wave()
	--print("current mode = "..mode, 20, 20, 7)
end

function change_mode_and_reset(new_mode)
	if new_mode == "start" then
		init_start()
		mode = "start"
	end
	if new_mode == "game" then
		init_game()
		mode = "game"
	end
	if new_mode == "over" then
		init_over()
		mode = "over"
	end
	if new_mode == "wave" then
		init_wave()
		mode = "wave"
	end

	--Resetting timers
	timers = {}
end

function change_mode(new_mode)
	if (new_mode == "start") mode = "start"
	if (new_mode == "game") mode = "game"
	if (new_mode == "over") mode = "over"
	if (new_mode == "wave") mode = "wave"
end

---game libraries---
#include libs/modes/game/init.lua
#include libs/modes/game/draw.lua
#include libs/modes/game/update.lua

---game additional libraries---
#include libs/modes/game/entities/enemies.lua
#include libs/modes/game/entities/ship.lua
#include libs/modes/game/ui.lua
#include libs/modes/game/fx.lua

---start libraries---
#include libs/modes/start/init.lua
#include libs/modes/start/draw.lua
#include libs/modes/start/update.lua

---gameover libraries---
#include libs/modes/over/init.lua
#include libs/modes/over/draw.lua
#include libs/modes/over/update.lua

---wave libraries---
#include libs/modes/wave/init.lua
#include libs/modes/wave/draw.lua
#include libs/modes/wave/update.lua

---utilities libraries---
#include libs/utils/text.lua
#include libs/utils/gameplay.lua
#include libs/utils/timers.lua
#include libs/utils/tables.lua

__gfx__
00000000000880000008800000088000000000000000000000000000000000000000000000000000088008800880088000770000000000000000000000000000
00000000009559000055900000095500000000000007700000000000000000000007700000000000878888888008800807007000000000000000000000000000
0070070000655600005568000086550000000000007cc700000770000007700000cccc0000000000878888888000000870055550000000000000000000000000
000770000865568008556800008655800000000000cccc00000cc00000077000000cc000000000008888888880000008a0555555000000000000000000000000
0007700088655688885568800886558800000000000cc000000cc000000cc0000000000000000000088888800800008000555505000000000000000000000000
00700700225c752222c7522002257c220000000000000000000cc000000cc0000000000000000000008888000080080000555505000000000000000000000000
00000000006556000055600000065500000000000000000000000000000cc0000000000000000000000880000008800000555555000000000000000000000000
00000000000880000008000000008000000000000000000000000000000000000000000000000000000000000000000000055550000000000000000000000000
09999000000000000003b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
997799000000000000bbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9a77a900000000000bb3bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9a77a900000000003b33bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9a77a90000000000bbbb33b300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9aaaa900000000000bbb3bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09aa90000000000000bbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0099000000000000000b300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00333300003333000033330000333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03377330033773300337733003377330000000000000000000000000000000000000000000777770000000000000000000000000000000000000000000000000
0bbbbbb00bbbbbb00bbbbbb00bbbbbb0000000000000000000000000000000000009990007799977000000000000000000000000000000000000000000000000
3b7777b33b7777b33b7777b33b7777b3000000000000000000000000000080000099899007998997000000000000000000000000000000000000000000000000
3b1717b33b7117b33b7171b33b7117b3000000000000000000000000000888000098889007988897000000000000000000000000000000000000000000000000
0bbbbbb00bbbbbb00bbbbbb00bbbbbb0000000000000000000000000000080000099899007998997000000000000000000000000000000000000000000000000
000bb000000bb000000bb000000bb000000000000000000000000000000000000009990007799977000000000000000000000000000000000000000000000000
00033000000330000003300000033000000000000000000000000000000000000000000000777770000000000000000000000000000000000000000000000000
00022000000220000044000040000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00211200002112000044000004004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02111120021111200044000000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21811812218118120444400004444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21111112211111124499440044994400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02188120021881204999940049999400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02211220022112204974940049479400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22000022022002204444440044444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000055000000000005000000000500005000000000000000000000000000000000000000000000000000
00000000000000000000000088800000000088088888000000055555555550000000000555005500000000000000000000000000000000000000000000000000
00000009999000000000088999980000000888899998800050555559999555055558000005000550000000000000000000000000000000000000000000000000
0000999aaaa900000000999aaaa980000008999aaaa988000555995aaaa955500055550055000855000000000000000000000000000000000000000000000000
0009aaa77aaa90000089aaa77aaa98000089aaa77aaa98800555aa5775559550058955555aa00085000000000000000000000000000000000000000000000000
0009aa7777aa90000099aa7777aa99000099aa7777aa99800559aa77755599505599aa7777a00085000000000000000000000000000000000000000000000000
0009a777777aa9000089a777777aa9000889a777777aa9805559a7777775595058555557777a0005000000000000000000000000000000000000000000000000
0009a777777aa9000089a777777aa9800889a777777aa9805889a777777aa95058500055755a0005000000000000000000000000000000000000000000000000
0009aa77777aa9000009aa77777aa9000089aa77777aa9005589aa77777aa95555855000555aa955000000000000000000000000000000000000000000000000
00009aaaaaaa900000099aaaaaaa980000899aaaaaaa980055899a5aaa5598550589500055509850000000000000000000000000000000000000000000000000
0000999aaaa900000000999aaaa988000088999aaaa9880005889555aa5585550585500005555550000000000000000000000000000000000000000000000000
00000099999900000000099999998000000089999999800005558599995985500555009500950050000000000000000000000000000000000000000000000000
00000009900000000000088998000000000008899880000050558559955855000000088500800000000000000000000000000000000000000000000000000000
00000000000000000000008000000000000000888000000000055555555550005500558008550000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000050000555555500500005050055550000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000055500000000005500000000005000000000000000000000000000000000000000000000000000000
88888808888808888808888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000008000808080808000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80888808888808080808888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000808000808080808000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888808000808080808888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888808000808888808888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000808000808000008000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000808000808888808888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
80000800808008000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888800080008888808008800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000070000020000200200002002000020020000205555555555555555555555555555555502222220022222200222222002222220
000bb000000bb0000007700000077000022ff220022ff220022ff220022ff2200578875005788750d562465d0578875022e66e2222e66e2222e66e2222e66e22
0066660000666600606666066066660602ffff2002ffff2002ffff2002ffff2005624650d562465d05177150d562465d27761772277617722776177227716772
0566665065666656b566665bb566665b0077d7000077d700007d77000077d700d517715d051771500566865005177150261aa172216aa162261aa612261aa162
65637656b563765b056376500563765008577580085775800857758008577580056686500566865005d24d50056686502ee99ee22ee99ee22ee99ee22ee99ee2
b063360b006336000063360000633600080550800805508008055080080550805d5245d505d24d500505505005d24d5022299222229999222229922222299222
006336000063360000633600006336000c0000c007c007c007c00c7007c007c05005500505055050050000500505505020999902020000202099990202999920
0006600000066000000660000006600000c7c7000007c0000077cc000007c000dd0000dd0dd00dd005dddd500dd00dd022000022022002202200002202200220
00ff880000ff88000000000000000000200000020200002000000000000000003350053303500530000000000000000000000000000000000000000000000000
0888888008888880000000000000000022000022220000220000000000000000330dd033030dd030005005000350053000000000000000000000000000000000
06555560076665500000000000000000222222222222222200000000000000003b8dd8b3338dd833030dd030030dd03003e33e300e33e330033e333003e333e0
6566665576555565000000000000000028222282282222820000000000000000032dd2300b2dd2b0038dd830338dd833e33e33e333e33e333e33e333e33e333e
57655576555776550000000000000000288888822888888200000000000000003b3553b33b3553b3033dd3300b2dd2b033300333333003333330033333300333
0655766005765550000000000000000028788782287887820000000000000000333dd333333dd33303b55b303b3553b3e3e3333bbe33333ebe3e333be3e3333b
0057650000655700000000000000000028888882080000800000000000000000330550330305503003bddb30333dd3334bbbbeb44bbbebb44bbbbeb44bbbebe4
00065000000570000000000000000000080000800000000000000000000000000000000000000000003553000305503004444440044444400444444004444440
0066600000666000006660000068600000888000002222000022220000222200002222000cccccc00c0000c00000000000000000000000000000000000000000
055556000555560005585600058886000882880002eeee2002eeee2002eeee2002eeee20c0c0c0ccc000000c0000000000000000000000000000000000000000
55555560555855605588856058828860882228802ee77ee22ee77ee22eeeeee22ee77ee2c022220ccc2c2c0cc022220c00222200000000000000000000000000
55555550558885505882885088222880822222802ee77ee22ee77ee22ee77ee22ee77ee2cc2cac0cc02aa20cc0cac2ccc02aa20c000000000000000000000000
15555550155855501588855018828850882228802eeeeee22eeeeee22eeeeee22eeeeee2c02aa20cc0cac2ccc02aa20ccc2cac0c000000000000000000000000
01555500015555000158550001888500088288002222222222222222222222222222222200222200c022220ccc2c2c0cc022220c000000000000000000000000
0011100000111000001110000018100000888000202020200202020220202020020202020000000000000000c000000cc0c0c0cc000000000000000000000000
00000000000000000000000000000000000000002000200002000200002000200002000200000000000000000c0000c00cccccc0000000000000000000000000
000880000009900000089000000890000000000001111110011111100000000000d89d0000189100001891000019810000005500000050000005000000550000
706666050766665000676600006656000000000001cccc1001cccc10000000000d5115d000d515000011110000515d0000055000000550000005500000055000
1661c6610161661000666600001666000000000001cccc1001cccc1000000000d51aa15d0151a11000155100011a151005555550055555500555555005555550
7066660507666650006766000066560000000000017cc710017cc71000000000d51aa15d0d51a15000d55d00051a15d022222222222222222222222222222222
0076650000766500007665000076650000000000017cc710017cc710000000006d5005d6065005d0006dd6000d50056026060602260606022666666226060602
000750000007500000075000000750000000000001111110011111100000000066d00d60006d0d600066660006d0d60020000002206060622222222020606062
00075000000750000007500000075000000000001100001101100110000000000760067000660600000660000060660020606062222222200000000022222220
00060000000600000006000000060000000000001100001101100110000000000070070000070700000770000070700022222220000000000000000000000000
0007033000700000007d330003330333000000000022220000000000000000000000000000000000000000000000000000000000000000000000000000000000
000d3300000d33000028833003bb3bb3000000000888882000000000000000000000000000000000000000000000000000000000000000000000000000000000
0778827000288330071ffd1000884200002882000888882000288200000000000000000000000000000000000000000000000000000000000000000000000000
071ffd10077ffd700778827008ee8e800333e33308ee8e80088ee883000000000000000000000000000000000000000000000000000000000000000000000000
00288200071882100028820008ee8e8003bb4bb308ee8e8008eeee83000000000000000000000000000000000000000000000000000000000000000000000000
07d882d00028820007d882d00888882008eeee800088420008eeee80000000000000000000000000000000000000000000000000000000000000000000000000
0028820007d882d000dffd0008888820088ee88003bb3bb3088ee880000000000000000000000000000000000000000000000000000000000000000000000000
00dffd0000dffd000000000000222200002882000333033300288200000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000149aa94100000000012222100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00019777aa921000000029aaaa920000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d09a77a949920d00d0497777aa920d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0619aaa9422441600619a77944294160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07149a922249417006149a9442244160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07d249aaa9942d7006d249aa99442d60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
067d22444422d760077d22244222d770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d666224422666d00d776249942677d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
066d51499415d66001d1529749251d10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0041519749151400066151944a151660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00a001944a100a0000400149a4100400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000049a400090000a0000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100002153021530205301f5301d5301a520175201552015520145201452012520105200f5200d5200a5200352019500195001a5001c5001d5002050022500225002450026500295002c5002f5003350000500
00010000340202802023020210201f0201e0201e0201d0201c0201b0201a0201a0201a0201a0201a0201a0201b0201d0202002025020270200000000000000000000000000000000000000000000000000000000
000500001a7401d7402374027700277002570022700237002f7003370034700327000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001000025550265502c5500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00140000221221f12216122161221b1221b1221b1221812213122111220f1220f122161221b1221b1221b1221b1221b1221b1221812216122131221112213122181221b1221f1221f1221f122221222212222122
0014000022120221201b120161201d1201b1200f1200c1200f1201b1201f1201f1201612011120131201b1201f1202112022120201201e1201c1201d1201e1201e1201b12018120161201612016120181201d120
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010f00001e050000001e0501d0501b0501a0601a0601a062000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
01 14494344
02 15424344
00 17424344

